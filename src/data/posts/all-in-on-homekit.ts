import type { Post } from '../types/posts.types';

const post: Post = {
  id: 20,
  slug: 'all-in-on-homekit',
  title: 'All in on HomeKit',
  date: 'January 04, 2022',
  excerpt: `I've shared a lot of pictures of my apartment, but I haven't spent a whole lot of time talking about how automated this place is. I put a lot of work into automating it and thought I'd do a writeup.

`,
  content: `
<p>I've shared a lot of pictures of my apartment, but I haven't spent a whole lot of time talking about how automated this place is. I put a lot of work into automating it and thought I'd do a writeup. Also all of the amazon links are affiliate links so I might make a dollar if you buy something.</p>
<p>I'm an Apple Enthusiast and I consistently opt in to whatever they provide in their ecosystem. We're up to two HomePod Classics, four HomePod Minis, multiple Macs, and several dozen iPods. Also the latest iPhone, iPad Pro, and the Apple Watch.</p>
<p>To put simply, if Apple has a product category, I've opted in. It's no surprise I went with HomeKit for my home operating system. HomeKit presents different challenges from the Alexa and Google ecosystems. For example, HomeKit requires developers register with Apple and meet certain hardware requirements on their products. As a result there are significantly fewer accessories that work with HomeKit. I do however find they generally perform better than non-HomeKit equivalents I've set up in other homes.</p>
<h2 id="layout">Layout</h2>
<p>We've got three main rooms in the apartment: The Office (or Guest Room), The Living Room, and The Bedroom. The bulk of the equipment is in The Office, so we'll start there.</p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/floorplan-markup.jpg" class="kg-image" alt loading="lazy" width="775" height="595"><figcaption><em>Marked up floorplan I used when planning.</em></figcaption></figure>
<h1 id="the-office">The Office</h1>
<p>The Office or The Guest Room, is where I spend the bulk of my day working from home. I picked green because it's a color that helps me stay awake and focus. Also it goes nicely with plants.</p>
<p>My work machine is a 2020 16" intel MacBook, a <a href="https://amzn.to/3EOlw2c">Dell 27" monitor</a>, and a <a href="https://amzn.to/337e992">Dell 24" monitor</a> vertically oriented. I also have my personal iMac which is a plex server for the apartment. Behind the iMac I use a <a href="https://amzn.to/3zq4HJK">variety</a> of <a href="https://amzn.to/3HE2a1k">cable management</a> boxes to hide the wires and a pair of <a href="https://amzn.to/3eOib8P">Philips Hue Play Bars</a> and <a href="https://amzn.to/3ztY9dk">Philips Hue Blooms</a> for lighting. Below is what it looks like on an average day.</p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/office-doorway.jpeg" class="kg-image" alt loading="lazy" width="2000" height="1500"><figcaption>Office Doorway</figcaption></figure>
<p>There's a pair of HomePod Minis as a studio pair I can use with either of the Macs. I also use my Airpods Max while working and for conference calls. </p>
<p>Behind the closet I've got a FreeNas, networking equipment, and hubs for the hue lights, shades, and overhead lights. I recently added a smart power switch so I can power cycle these from my phone. </p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/server-closet.jpeg" class="kg-image" alt loading="lazy" width="2000" height="2667"><figcaption>Server Closet</figcaption></figure>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/office-bed-bookshelf.jpeg" class="kg-image" alt loading="lazy" width="2000" height="1500"><figcaption>Office - Bed and Bookshelf</figcaption></figure>
<p>This room has a few lamps, most notably the <a href="https://amzn.to/3GbaPbD">hydra lamp</a>, and the <a href="https://amzn.to/3eSkUOA">hotel style usb lamp</a>. I also have a <a href="https://amzn.to/3mVrwQu">charging station</a> at the bed for guests. The various lamps in the room are all <a href="https://amzn.to/3t1W7Qe">Philips Hue White bulbs</a> with <a href="https://amzn.to/3pVRvcG">VOCOLinc smart plugs</a> for the bookshelf lights and lava lamp. </p>
<h2 id="networking">Networking</h2>
<p>The apartment network is powered by a Ubiquity Dream Machine, a ton of <a href="https://amzn.to/3F7jjzb">UniFi switches</a>, and a few <a href="https://amzn.to/3eVBvRi">WiFi 6 access points</a>. The Dream Machine lives behind the iMac with the bulk of the switches in the server closet. I also have a <a href="https://amzn.to/3mVla3A">Raspberry Pi</a> running <a href="https://pi-hole.net">Pi-hole</a> as a DNS level ad-blocker.</p>
<p>I drilled a small hole in the walls against the Living Room and Bedroom to send an ethernet cable to the other room.</p>
<h1 id="the-living-room">The Living Room</h1>
<p>The Living Room is where I watch TV with the cats or hangout with friends I'm entertaining. <a href="https://amzn.to/3mRqtBd">AppleTV</a> was a no-brainer. The display is a <a href="https://amzn.to/3JKwc5t">LG GX65 OLED</a>. Theres a <a href="https://amzn.to/3JH08zz">Philips Hue Gradient Strip</a> along with <a href="https://amzn.to/3qIxSUu">two Play Bar lights</a> synced with the <a href="https://amzn.to/3pSpZws">Hue Play Sync Box</a>.</p>
<p>This is hooked up to a <a href="https://amzn.to/3pQ0j3z">Sonos Arc</a>, Two Rear <a href="https://amzn.to/3EUDxMl">Sonos One SLs</a>, and a <a href="https://amzn.to/3zr4PIT">Sonos Sub</a>. Each of these is connected via ethernet using wires running under and behind the furniture. I use these <a href="https://amzn.to/3pU8UCh">cord protectors</a> to keep the cables neat and protected from the cats. I have <a href="https://amzn.to/3r7548z">this charging station</a> on the end table, along with chargers next to the AC unit for on-couch charging.</p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/living-room.jpeg" class="kg-image" alt loading="lazy" width="2000" height="1500"><figcaption>Living Room</figcaption></figure>
<h2 id="lighting">Lighting</h2>
<p>Separate from the television lighting system, every light in the apartment is smart. </p>
<p>Most of the Living Room bulbs are <a href="https://amzn.to/3t1W7Qe">Philips Hue White bulbs</a>, however the <a href="https://amzn.to/32ZhBSU">couch lamps</a> are using <a href="https://amzn.to/3pSLXPS">Philips Hue Color bulbs</a> for fun scenes. I tried syncing these with the TV but it ended up being more annoying than fun.</p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/living-room-behind-couch.jpeg" class="kg-image" alt loading="lazy" width="2000" height="1500"><figcaption>Living Room - Behind the couch</figcaption></figure>
<p>In the dining room I have this <a href="https://amzn.to/334npKL">larger lamp</a> along with the three bulb unit I got at a local hardware store. The overhead lights are using <a href="https://amzn.to/3JBbDsl">Caseta Lutron</a> switches. The water fountain for the cats is hooked up to a <a href="https://amzn.to/3nimFJB">VOCOLinc smart plug</a> so I can turn it on/off with the lights.</p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/dining-room.jpeg" class="kg-image" alt loading="lazy" width="2000" height="1500"><figcaption>Dining Room</figcaption></figure>
<h1 id="kitchen">Kitchen</h1>
<p>The kitchen has a surprising amount of tech packed into it. Under the cabinets are <a href="https://amzn.to/3EPLsdD">Philips Hue lightstrips</a> that can change color. I mostly use these to light the countertops. I attempted to use these for the office bookshelf but it was a nightmare splicing them and I went with a cheaper IKEA solution. There's a HomePod mini in the kitchen that I use mostly for siri but occasionally for music. </p>
<p>I also have a <a href="https://amzn.to/31r0J77">GE Opal ice maker</a> that I adore. It's a nightmare to clean though.</p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/kitchen.jpeg" class="kg-image" alt loading="lazy" width="2000" height="1500"><figcaption>Kitchen</figcaption></figure>
<h1 id="the-entryway">The Entryway</h1>
<p>The first thing you see when you walk into the apartment is a television hooked up to a raspberry pi. I use <a href="https://dakboard.com/site">DakboardOS</a> to power a display that shows me my daily calendar along with updating news. This is exceptionally useful when I'm pacing between my office and the kitchen during the work day.</p>
<p>Most of the panels were available out of the box, but I had to roll my own <a href="http://github.com/matthew-gerstman/tweetonescreen">tweet visualizer</a> in the lower left hand corner.</p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/entryway-dakboard.jpeg" class="kg-image" alt loading="lazy" width="2000" height="2667"><figcaption>Entryway Dakboard</figcaption></figure>
<p>I also have <a href="https://amzn.to/3pWhdxm">Eufy Pan and Tilt cameras</a> here and in every other room so I can watch the cats or check on the apartment when I'm out of town. </p>
<h2 id="the-bedroom">The Bedroom</h2>
<p>In the the bedroom I took things up a notch with <a href="https://amzn.to/3324wYS">White Ambiance</a> bulbs. I like these because the temperature is warmer at night and easier on the eyes. The television is connected to an Apple TV with two HomePod Classics in a stereo pair. I connected my vintage turntable to the Homepods with <a href="https://amzn.to/3zshGuH">this adapter</a>, a <a href="https://amzn.to/3pSkOfY">Behringer USB preamp</a> and <a href="https://www.airchordapp.com">AirChord</a> running on my old iPad.</p>
<p>There are a pair of <a href="https://amzn.to/3sYnMkX">Philips Hue Edison Bulbs</a> in <a href="https://amzn.to/3pUGDvC">these lamps</a>. </p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/bedroom.jpeg" class="kg-image" alt loading="lazy" width="2000" height="1500"><figcaption>Bedroom</figcaption></figure>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/bedroom-media.jpeg" class="kg-image" alt loading="lazy" width="2000" height="1500"><figcaption>Bedroom Media</figcaption></figure>
<h1 id="scenes">Scenes</h1>
<p>All this integration means I can do a lot of nifty things with scenes. First, theres some simple automation. The couch lamps and the steel lamp both turn off at 5 PM every day. The bedroom shade automatically lifts at 7:30 AM on weekdays which abruptly informs the cats its time to wake me up.</p>
<p>The AC is controlled with a <a href="https://amzn.to/3FV8AZv">Sensibo Air</a> to make the window units smart.</p>
<p>The scenes I use every day are Good Morning and Good Night. Good Morning opens every shade, turns on every light to 100%, and boots the entryway TV up. Good Night turns off every light. There's another scene: Make it Dark, that turns off every light and closes every shade. </p>
<p>Each room has a <a href="https://amzn.to/31oY8dQ">hue dimmer switch</a> that controls the whole room. I made two scenes for each room, Room One and Room Zero. Those turn off every light and control the shades. In between those I have scenes that brings an assorted set of lights on. For example in the kitchen I have a scene that only turns on the countertop lights.</p>
<p>My favorite scene is Lullaby which turns off my TV, closes my shades, and begins playing a playlist in the bedroom currently composed of The Postal Service, Taylor Swift, The Postal Service again, and Billie Eilish. There's also Nap Time which does all this and turns off the bedroom lights.</p>
<p>In the same vein, Nightlight turns on a dim light in the master bathroom, kitchen, and living room. </p>
<p>For anything Marvel, I put on TV Time which closes the shades and turns off any light that I can see from the Living Room, including the entryway TV. It's counterspell is Chill, which opens all shades and turns every light in the apartment to 50%. I used <a href="http://leviosashades.com">Leviosa Shades</a> which integrate with HomeKit, although I wish the bridge was more reliable.</p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/home-app-overview.png" class="kg-image" alt loading="lazy" width="2000" height="1397"><figcaption>Home App Screenshot</figcaption></figure>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/home-app-bedroom.png" class="kg-image" alt loading="lazy" width="2000" height="1397"><figcaption>Home App Screenshot - Bedroom</figcaption></figure>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/home-app-kitchen.png" class="kg-image" alt loading="lazy" width="2000" height="1397"><figcaption>Home App Screenshot - Kitchen</figcaption></figure>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/home-app-living-room.png" class="kg-image" alt loading="lazy" width="2000" height="1397"><figcaption>Home App Screenshot - Living Room</figcaption></figure>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/home-app-office.png" class="kg-image" alt loading="lazy" width="2000" height="1397"><figcaption>Home App Screenshot - Office</figcaption></figure>
<h1 id="speakers-and-music">Speakers and Music</h1>
<p>I've already touched on the speakers but I'll reiterate and be a bit more thorough this time. The Office has a paired set of HomePod mini's that I use with the computers. The bookshelf has a <a href="https://amzn.to/31tr0lo">Sonos Five</a> connected to a <a href="https://amzn.to/3mZjuGj">Fluance RT85</a> turntable for vinyl. This can stream vinyl throughout the entire apartment.</p>
<p>The Bedroom has a pair of HomePod Classics for primary listening. The turntable is a vintage Sanyo with an <a href="https://amzn.to/331ORsA">Ortofon Blue cartridge</a>. I like to read and listen to records on this setup. I occasionally put the <a href="https://amzn.to/3pSzN9K">Sonos roam</a> in here if I'm doing a project where I'm running between rooms and want to listen to vinyl.</p>
<p>I've also got one of two iPod displays in the Bedroom. I love iPods, they were iconic during my formative years and are a form of Apple Nostalgia for me. The iPod Mini display includes one of each color with a different artist on each. They are from left to right Green Day, Taylor Swift, Coldplay, Blink 182, and Frank Turner. They also work! I stream them to an old Zenith radio using an iTrip.</p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/ipod-mini-display.jpeg" class="kg-image" alt loading="lazy" width="2000" height="2667"><figcaption>iPod Mini Display</figcaption></figure>
<p>The Living Room is where the magic happens. The main system is a <a href="https://amzn.to/3pQ0j3z">Sonos Arc</a>, two rear <a href="https://amzn.to/3EUDxMl">Sonos One SLs</a>, and a <a href="https://amzn.to/3zr4PIT">Sonos Sub</a>. This sounds fantastic for movies and is also a great party system.</p>
<p>To the right I have the iPod Classic display. This contains each generation of iPod and the first five generations of iPhone. All of these devices work and are loaded with content.</p>
<p>There's also an iPod Hi-Fi that can accept any of the iPods with dock connectors and play their music. Inside the box is an Airport Express to pair this speaker to AirPlay 2. I mostly use this speaker when I'm working out in the landing strip between the carpet and the display or when I'm drunk and feel like dancing.</p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/photo-wall-ipod-display.jpeg" class="kg-image" alt loading="lazy" width="2000" height="1500"><figcaption>Photo Wall With iPod Display</figcaption></figure>
<p>Finally, there's a HomePod mini tucked away in the back that I exclusively use for Siri.</p>
<h1 id="legacy-macs">Legacy Macs</h1>
<p>Behind the couch is my legacy mac setup. There's a few machines here. There's a 2014 Macbook Pro I use to manage all of my devices. A 2009 Macbook Pro I use to manage some legacy iPads. and my favorite, a 2007 Black Macbook that's dual booting Snow Leopard and Windows XP.</p>
<p>These are mostly toys, but they all work and I use them for projects.</p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/macbook-windows-xp.jpeg" class="kg-image" alt loading="lazy" width="2000" height="1500"><figcaption>2007 Macbook running WIndows XP</figcaption></figure>
<h1 id="bugs">Bugs</h1>
<p>I'm really proud of this thing I built, but it definitely has it's quirks. The various bridges all need to be reset from time to time, and I once just turned off the circuit breaker to turn off everything at once and reboot the whole apartment. Recently, I added a <a href="https://amzn.to/3HvAuvy">smart power switch</a> so I could power cycle the bridges from my phone. The Pi-hole DNS is one of the most likely things to crash so I have that plugged into it as well.</p>
<p>Scenes featuring music are particularly unreliable. Lullaby and Nightlight will work for a while and then stop. I used to have a scene called Tunes that would play a playlist on every speaker in the house, but I gave up after too many failures.</p>
<p>There's also an issue where the living room AppleTV is slightly out of sync with other AirPlay devices. I work around this by unplugging the Sonos Arc and airplaying directly to it when I want to use multiple speakers at once.</p>
<p>Another issue is Siri always feels the need to tell me when one or more devices didn't respond. This is great in theory, but is almost never useful. I consistently repeat the request and it works the second time. It also doesn't give me any insight into which device failed. Many of my scenes are controlling 30+ accessories so I have no way of knowing if a bridge is down or the bathroom light is just off. It'd be nice if the home app gave me this info.</p>
<figure class="kg-card kg-image-card kg-card-hascaption"><img src="/images/blog/all-in-on-homekit/home-app-misc.png" class="kg-image" alt loading="lazy" width="2000" height="1397"><figcaption>Home App Screenshot - Misc</figcaption></figure>
<p></p>
<h1 id="wrap-up-and-feature-requests">Wrap Up and Feature Requests</h1>
<p>The main tools I used to make this apartment smart were Philips Hue bulbs and fixtures, Apple devices, the Leviosa Shades, and a bunch of VOCOLinc adapters. From there it was a massive time investment to get everything working the way I wanted it to.</p>
<p>Scenes are a small nightmare to compose. Any time I add or move I light I need to modify every single scene it's in. I would love to see composable scenes where I can say "this is the office in chill mode" or "this is the bedroom 100%". This way I could make Good Morning the composition of Bedroom One, Living Room One, and Office One.</p>
<p>I would also love a guest mode. Whenever I have someone visiting I need to be careful with apartment-wide scenes while they're sleeping. It would be great if I could just make a room automonmous for a period.</p>
<p>The home app is overdue for a makeover. It was perfect when I lived in a 350 sqft studio apartment, but now that I have multiple rooms, many accessories, and many scenes it's unweildy and unreliable. I'm hoping that Apple improves this in a future release.</p>
<p>Overall though, I'm happy I went with HomeKit. It integrates with everything else I own and Apple's track record on privacy is next to none. I really hope Apple improves the stability of HomeKit and HomePods over the next few years, but until then I'll keep tinkering.</p>
`.trim(),
  tags: ['Tech'],
  banner_img: '/images/blog/living-room.jpeg',
  heroImage: '/images/blog/all-in-on-homekit/homekit-hero.jpeg',
  wordCount: 2315,
};

export default post;
